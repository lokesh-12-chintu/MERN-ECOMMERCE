{"ast":null,"code":"import axios from \"../helpers/axios\";\nimport { cartConstants } from \"./constants\";\nimport store from \"../store\";\nexport const addToCart = (product, qty = null) => {\n  return async dispatch => {\n    const {\n      cartItems\n    } = store.getState().cart;\n    const qty = cartItems[product._id] ? parseInt(cartItems[product._id].qty + qty) : 1;\n    cartItems[product._id] = {\n      ...product,\n      qty\n    };\n    dispatch({\n      type: cartConstants.ADD_TO_CART,\n      payload: {\n        cartItems\n      }\n    });\n    localStorage.setItem(\"cart\", JSON.stringify(cartItems));\n  };\n};\nexport const updateCart = () => {\n  return async dispatch => {\n    const cartItems = localStorage.getItem('cart') ? JSON.parse(localStorage.getItem('cart')) : null;\n    if (cartItems) {\n      dispatch({\n        type: cartConstants.ADD_TO_CART,\n        payload: {\n          cartItems\n        }\n      });\n    }\n  };\n};\nexport const getCartItems = () => {\n  return async dispatch => {\n    try {\n      dispatch({\n        type: cartConstants.ADD_TO_CART_REQUEST\n      });\n      const res = await axios.post(`/user/getCartItems`);\n      if (res.status === 200) {\n        const {\n          cartItems\n        } = res.data;\n        console.log({\n          getCartItems: cartItems\n        });\n        if (cartItems) {\n          dispatch({\n            type: cartConstants.ADD_TO_CART_SUCCESS,\n            payload: {\n              cartItems\n            }\n          });\n        }\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n};\nexport const removeCartItem = payload => {\n  return async dispatch => {\n    try {\n      dispatch({\n        type: cartConstants.REMOVE_CART_ITEM_REQUEST\n      });\n      const res = await axios.post(`/user/cart/removeItem`, {\n        payload\n      });\n      if (res.status === 202) {\n        dispatch({\n          type: cartConstants.REMOVE_CART_ITEM_SUCCESS\n        });\n        dispatch(getCartItems());\n      } else {\n        const {\n          error\n        } = res.data;\n        dispatch({\n          type: cartConstants.REMOVE_CART_ITEM_FAILURE,\n          payload: {\n            error\n          }\n        });\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n};","map":{"version":3,"names":["axios","cartConstants","store","addToCart","product","qty","dispatch","cartItems","getState","cart","_id","parseInt","type","ADD_TO_CART","payload","localStorage","setItem","JSON","stringify","updateCart","getItem","parse","getCartItems","ADD_TO_CART_REQUEST","res","post","status","data","console","log","ADD_TO_CART_SUCCESS","error","removeCartItem","REMOVE_CART_ITEM_REQUEST","REMOVE_CART_ITEM_SUCCESS","REMOVE_CART_ITEM_FAILURE"],"sources":["C:/Users/jitta/MERN-ECOMMERCE/flipkart-clone/src/actions/cart.action.js"],"sourcesContent":["import axios from \"../helpers/axios\";\r\nimport { cartConstants } from \"./constants\";\r\nimport store from \"../store\";\r\n\r\n\r\nexport const addToCart = (product,qty = null) => {\r\n  return async dispatch => { \r\n    const {cartItems} = store.getState().cart;\r\n    const qty = cartItems[product._id]\r\n      ? parseInt(cartItems[product._id].qty + qty)\r\n      : 1;\r\n    cartItems[product._id] = { \r\n      ...product, \r\n      qty\r\n    }\r\n    \r\n    dispatch({ \r\n      type:cartConstants.ADD_TO_CART, \r\n      payload: {\r\n        cartItems\r\n      }\r\n    })\r\n    localStorage.setItem(\"cart\", JSON.stringify(cartItems));\r\n  }\r\n}\r\n\r\n\r\nexport const updateCart = () => { \r\n  return async dispatch => { \r\n    const cartItems = localStorage.getItem('cart') ?  \r\n        JSON.parse(localStorage.getItem('cart')) : null; \r\n    \r\n    if(cartItems){ \r\n      dispatch({ \r\n        type: cartConstants.ADD_TO_CART,\r\n        payload: {cartItems}\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\n\r\nexport const getCartItems = () => {\r\n  return async (dispatch) => {\r\n    try {\r\n      dispatch({ type: cartConstants.ADD_TO_CART_REQUEST });\r\n      const res = await axios.post(`/user/getCartItems`);\r\n      if (res.status === 200) {\r\n        const { cartItems } = res.data;\r\n        console.log({ getCartItems: cartItems });\r\n        if (cartItems) {\r\n          dispatch({\r\n            type: cartConstants.ADD_TO_CART_SUCCESS,\r\n            payload: { cartItems },\r\n          });\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n};\r\n\r\n\r\n\r\nexport const removeCartItem = (payload) => {\r\n  return async (dispatch) => {\r\n    try {\r\n      dispatch({ type: cartConstants.REMOVE_CART_ITEM_REQUEST });\r\n      const res = await axios.post(`/user/cart/removeItem`, { payload });\r\n      if (res.status === 202) {\r\n        dispatch({ type: cartConstants.REMOVE_CART_ITEM_SUCCESS });\r\n        dispatch(getCartItems());\r\n      } else {\r\n        const { error } = res.data;\r\n        dispatch({\r\n          type: cartConstants.REMOVE_CART_ITEM_FAILURE,\r\n          payload: { error },\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n};\r\n\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}